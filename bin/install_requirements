#!/bin/bash

RED='\033[0;31m'
PURPLE='\033[0;35m'
RESET='\033[0m'
script="$(basename $0)"
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

log() {
  echo -e "${PURPLE}${script}:${RESET} $1"
}

fail() {
  echo -e "${RED}${script} failed:${RESET} $1" >&2
  exit 1
}

cd $SCRIPT_DIR

## remove RVM

if which rvm > /dev/null; then
  log "rvm detected. Imploding..."
  rvm implode
  log "rvm imploded."
fi

## Atom Packages

if which atom > /dev/null; then
  log "Installing atom packages..."
  apm install --packages-file "../requirements/atom-packages.txt"
  log "Atom packages installed."
fi


log "\n\n====> Atom Packages install complete <====\n"
read -p "Press enter to continue."
clear

cd $SCRIPT_DIR
case "$(uname -s)" in

   Darwin)
     ## operating system is Mac OS
     chmod +x install_requirements_mac
     ./install_requirements_mac
     ;;

   Linux)
     ## operating system is Linux
     chmod +x install_requirements_linux
     ./install_requirements_linux
     ;;

   *)
     log 'Unsupported OS'
     ;;
esac

# Git Completion
git_url="https://raw.githubusercontent.com/git/git/master/contrib/completion"
curl "$git_url/git-completion.bash" > "$HOME/.git-completion.bash"
curl "$git_url/git-prompt.sh" > "$HOME/.git-prompt.sh"
log "Git completion installed."

log "\n\n====> Git and Git Completion install complete <====\n"
read -p "Press enter to continue"
clear
